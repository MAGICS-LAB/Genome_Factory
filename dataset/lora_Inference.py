import torch
from transformers import AutoTokenizer, AutoModel,AutoModelForSequenceClassification
from peft import PeftModel
tokenizer = AutoTokenizer.from_pretrained("./lora_Trained_model",trust_remote_code=True)
base_model = AutoModelForSequenceClassification.from_pretrained("zhihan1996/DNABERT-2-117M", num_labels=10, trust_remote_code=True)
model = PeftModel.from_pretrained(base_model, "./lora_Trained_model")

dna="TGTCTGCAGCTGCTGCCAGTACTAGTAAGTCTGCTGAAAAGGAGAAACCTGTTACCAAAAAGGAGTTGAAAAGAAGGGAAAAGCAAGCATTGCTCGAAAAGAAAAAGAAACTGTTGGAAATTGCCAGGGCTAATATGCTTGAAAACATGCAAAAGAGCCAAGAGGGAAATACTCCCGACCTAAGCAAGCTCTCTTTGCAAGAAAATGAGGAGAACAAGGAAAAGGAAGAACCTAAGAAGGAGGAGCCTGAACAGTTGACCGAGGAAGAAATGGCGGAAAGAGTAATGCAAGAAAAGCTACGCAACAGAGTCGATATTCCACTGGAACAATGTCTATTTTGTGAGCACAATAAGCACTTCAAAGATGTTGAAGAAAACCTGGAACACATGTTTAGGACCCACGGGTTTTATATCCCAGAACAGAAATATCTAGTCGACAAGATCGGCTTGGTAAAATACATGTCGGAGAAGATTGGTCTTGGGAACATTTGTATTGTTTGTAATTACCAGGGGAGAACGTTGACCGCTGTAAGACAGCACATGTTGGCAAAGAGACACTGTAAAATTCCCTACGAAAGCGAGGATGAAAGGTTGGAGATATCTGAATTCTACGATTTTACAAGCTCATACGCAAACTTTAATAGCAACACAACACCAGACAACGAAGATGACTGGGAAGACGTGGGCAGCGACGAAGCCGGAAGCGACGACGAAGATCTGCCACAAGAGTACTTATATAACGATGGTATAGAGCTGCATCTACCGACAGGCATCAAAGTTGGCCACAGGTCCTTGCAAAGATACTACAAGCAAGACTTAAAGCCCGAGGTGATACTGACCGAAGGCCAAGGTACCCTGGTCGCTGCAGAGACGAGATCGTTCTTACCTGCCTTCGACAAAAAGGGCGTGCAGACTCAACAGCGTGTTTGGCAAACTGAGAGGTTCGACAAGAAAAGGCTCGATAAGAGAAGTGCCAAGTTCGTCAATAACCAACCACACTACAGAGACCAACTTCTGCAGTAATTCTTTTTGCACTACTTTTTTTAGTATTTTGTCGCATATATACTGCTTCACCATTTGTACATTAGATAATTCTTCACTACCCCCTCTATAGCAATGTTATAGTCATTGAATCATGCTTTGAAATGCCTGTTCTAATATTCTCTTCATATAATAAATGCGTGATGCCGGGTATTTGTGCGCCCTTGTTTGGCGCAAAAATCTCGAAAGTGAAAAAACTAATAGGCTTCTTAAAGCAGTTATATCTACAGCAAAGGAAATAGCTGCTGAAGACTGAAGATGTTGGCGCGCAGTTTGGGTTACAGGTTGATATCGACCAGTCGTATCTTATATAATAAACCCACGGTTAAGTCAGTGGTGTCGTCGTGTCCTGCGGGAACATCGCTTAACTTAAACATATGGAAGAGCGGTAAAGACGCAGTGGCACTCGAGGACAAGGAGTATCCAAATTGGTTATGGAGCGTATTGGATAGTGATCACGTTGTCGAACATGCGGCTGAGGACCCAGAGGGACAGGCTCTCTTAAAGAGAAGAAAGAACATAAGGAAGGCGAACAGGCAGCGAATCAAGCAAAACAATTTCTTGAGCCAACTTTAAGCCTCCGTTAATAAGATCAAGTTTGGTATCCTTGTAAATAAATATGTGTGTACGTGGTTAAATAGTATGTTTTTAGCATAATGCCTTATTTTGTACCAACAAAAACATGATAGTTCCCACATATCTTTTCGCCTGGGGAATACCAAGTGGGACAAACAAAACGTTAAAAATTAAATCCTTTAGAGTACCACAAATTCGCAAGAAACAAGATAGTTGAATTGTCAATCATGGCTAAGATAAGTATGAATGTGCCCAGTGTAAAGATCAAAAACATGCCAAAGGTAAGGTTAAAAAGCACTAGAAAGACTGTCTCCACGAAAAACATGCGAAATAGGTTCAATTCATACTCGAAAAGAATTCGAAGGACGCTCACAAGAAAGAGATTTTAGGCAAACATGAAACGTATGCATTTCATAACACACACATATATATATTATATATTCAAAATAAAGCATAACAACATACATATTGAAAAGTAAATTGAACGTTACGCAGTTTCATCAAATAAGAATAGTATTATTAAAAATTGGCCGGACCAAATATCTAGAAATCCGTTACTCTTCCGTTAAACGAATAATCGCCGTGTCTCAACGGGTCCTGCTTGGGACCCCCAACTTCACCAGTCTTGGGGTTAACATCACCTTCGAATTCAGGTATGGTCTTGGAAAATTCAGGCGAGAATGACCCAATATCGTTTTTGGTTAAAAGCGGTGAATTCAAACTCTCCTTTGTACGATCGCCGGTGGCCTGCGCATTATACTGATCTATTGCCTCTTGCGATGTGGCAATCCTCTGAAGTCTTTCGAACTCTTCCTGCTCTTCTCTTGGCAGCTTGGGAGGGCCGGGGATCCTTTCAGTAGTTATTTTTCGGGTGGCCATATTAAATGGTCGTCCACGTAGTAGATTTAAGGCTCCCGTGCGAGGATACCGATAACCTGTGCTTTTGATGGCGCACAACATTAGTTCTTCTTTTTATTATTTGGTTCTTTCTGACTCTTTAGCAAGTTAATATGATCTGCACTTTCCCCATTGGCCCCTTTATAGGGCGGAAAAGAGCATCTGTTTTTCCGGATTCTTGGAACAAGAAAAAGGAAATACACCTATCTATATGCCACTATTGTATATTACTAAATAAAATATTTAATTATATACTCATGCGTATGCCCTCAAGAAGTTCACCAATAATTCTTTGGTTTCTGCTGTTACCTTTTATGGTATTCAGGATCCCAAAACACTGCAGCAGCGTCAGTTTATCTTCCTCTGTGACGCCGTTCTGTTCTTCCTCGCTGAAAATATATCTTTGAAAACTCTTACTGGCACCGTCATTTGTATGTAGGAAGCTTTCGTAATACGGAAGAATGATGGAGTCTCTAAAACACTTTAATAAAAGGACATCAATTGACGGTGCGTACCTTGAAGGTTCAGATAGATATCCGTCAAGCCAGTAGTTACTATTTTTTTGGAAGCTTTTCTCGAAGGGCAGTAACACTGCCATCATGTCGTAGTAAACCTGTTGGTAAAACACCTTCCAGATTATGCCGACTCTTTTCAAAGCCGTATTTACGGTATCCTCATTGGCATAATTGAACACAATCTGGTTCTCTAAAATGTAAAGTGAAGTGGTAATGAATTCCTCGATTTCGGCCAAAAACCTTGAGTGCGTTACGGCAGCCTTGGTTTGTGTTTTCAAAGTGATATAAAATTCCAGCAGCCGGTCAATATCTTCTATTTTTGCTGGCAATTGCCATACCCTCTTGTTTTTAAATAGCTCCACAACTATGCTGCAGTATATACCCCAGATATTCCCCTCCAGAACAAATAACTCCTGTACGGTGAAGCTTTTATAGTTTGCTATCAAGGATGGCAAGTTTTTCAGTAAATCATGTAGTAAAGAAACATTAGTCGCGTCGAAAGCATCATCTTGGATCAGCGATAGAGCTGTATCATTAGGGTTGTTGTTAATGCTAGGGTTAAAGGAATATACAGATTTTCCAGAGTCAATAAGGCCTCCAGTAGAAGTATGGATAAACTGTACGGGTGACCTATGTTTACCATATGAAGAATGCAGAAATTTACTGAATGGGCTGGGAACTACGGGTTCAACGTCGTCTTTACCAATGGAATTATGCGGCTTGTAGGGTAAAAGCTTTTTTGCCATTTTGCTAAAGACATTACTGCCTTTGTTTGAATGAGAATGTCCTGTAGACAGTGAAGATTGTAAACTGTTCACACTCATATTAGATTTCGTATGAAACAATTTAGAGCCACTCCTACTTATGTTGTTACTACTTGTGCCGGTAATAACAGTGCCGTAGTTTTTTGACCCGCTCCTGCTTCGATTTCTCATATTATCTTTTGAATTGGTGAAGATGGACAGTCGCCTTTTATTGCCCCTTGAGTTGGAAGAAAATAAACTATCATTAGACGTGGTGTTCCCCTCCATTCGGTTACTACTTGATGAACCTATTTCGGAGTGACCATCGTTATTCTCCGTGCCTTGGCTGTACTCCTCTTCAATCGAATCCGTCGAGCGCCTTGCATTGGAACCATCATGGAATATAGATTGAAACCCCACCTGTGACCATCTAGGAGCGGCATCATGAGGAGATTTGGATGTTTTTAGATGCACATCTTCGTCGGGATGTGTCAGCGCTTGCGGTACTATATCAGAAGAAACACTATAAACTCTAGCTGGTTTGCGATTAGTTGCTTTTATGTTCGGGTTCGTGACGCTCAGTGAGCCTGAGGTAGCACTTCTTTTACGATTTAGGTCTGTTGCCATTGCTTGACTCTGTAGTTTAAGACTCGCCTAGCCACTTATGCTTATTGTGGTTTGTATTTTTTATTTACTGTCTTCTATCTTTCTCCCTTTAATTTTGACCTTATTTTAAAGCCCGCAAAGATCGCTGAAAAATTGCTAGTAAAGGTCGCATGCAAAATGGATAAAGTGCTCTTGTCAAATTATTTCAACACCTTCATTCGCAGTATAGTGGTATATTGGATTGGGTAAAGGAAAACAGGCGACACCAATATTGGTTTAAGCTAGTAGCGTATGCAGCTCTATCCAGGCATTAAAATTGGTTCACCTATTTCTGATAGTAGTTTTTTTTTTTCCAATCGTAAATTTTTTCTTCAATTTCGCGATGAGCTACAAAATAATAGTAGTGCAATCTGTATATTACTTTTCAAGTATCTAACTCATGCAAGTTAGGAGTTCCATAGCGGATATTTCACTATGTTTGATCCTCTCGATTTGTACACCCCTGATGACATCCAGGTTGAGGCTTTACAGTTCAATCTAGCAGAGAGAGAGCCAAAAGATCCTTGCTCACCGCAACGTGACGAAATATTAACGGCTGTAGATGAAGAAGAGAGTGACGACGATGACACCATTATCGATAATCTGGATCTGCCCTCCGTGAAGTATGCTCCGCCAGAAGTTATCCTTTGTATACTAATACTTCTGAAGCCCGATAGACAAGTAAACTTCAATCAGGAGACAGGGAAGAACAAATCTGTACTGGAGGTTTGCAAGAGTCATGGGCTGGAACCCGATCTGCTGAAAAGACTTTTGACTTGGTATACAGAAGAATGGCCTAACAAGAGGTTAAACTCGTTGGAAAAGATATGCAATAAAATCCCAATGCTGAGATTTACAGTATCCAAAGAACTACTGTTGGGCTACTATACTAGTGTATTGAAAAAATACAATAATAGTTGCGGATTGAATGAGGAAATCATACAAGAACTTCTTAAGGAATTGAGCTCAAGGATATCCGAAAACTGTGGGAGAACGGCCCAACCATCCATAGTAAGATATTTTGAATTAAGAAATCTAAGCACTTCCATACCGCTTCATGAACCCTCTTTAACGGCCGATAATCTTGGTTGGAAAACATGGGGATCATCTTTAATACTTTCACAATTAGTCGTAGATCACCTGGATTACCTACATACCACTAATGTGAACATGTTAGCGAACAGCGACATCAAACAGATTAAAGTATTAGAATTAGGAGCGGGCACTGGTTTAGTAGGACTTTCATGGGCCTTAAAATGGAAAGAACTTTATGGAACTGAAAATATAGAAATCTTCGTGACGGATTTACCCGAGATTGTGACGAATTTGAAGAAAAATGTGTCATTAAATAATTTAGGAGATTTCGTTCAAGCAGAGATATTAGATTGGACTAATCCTCACGATTTTATAGATAAATTTGGACATGAAAATGAATTTGACGTCATATTGATCGCCGACCCGATATATTCGCCTCAGCATCCGGAATGGGTAGTTAACATGATATCGAAGTTTTTGGCGGCATCAGGGACCTGTCACCTAGAAATACCTTTAAGGGCAAAATACGCCAAAGAACGAGAGGTTTTGAAATTATTACTAAAAGAGAGTGATTTAAAAGTAGTTGAAGAACGGCATTCAGAGGGTGTGGATGATTGGGGTGCCGTTAAGTATTTATATAGGCAAATCGTTCGCAATTAGTGGGAAAGAAACGAACGCGCTTAGGCGAATAGTTTTTCTTTATAATAAAAATCATGCATGCTACATAGACATTGAAATGTGAATTATAAGTACTTGCCAGACCTTACATACTGATTTATACAATTTATGGAGAAGAAAACTGAATGGGCCACCTCGCCAAAAGGTTAGTTTTTGATTCAGACAGGAATCAATACTGGTAGTACATTAAACAATCAAGGCCGCCTTTATAGTTGCGCTTATGCAACATAATCATCTGCAATCTGCAATCTTAGTTTCACTGCCTGTGGAATAATTTTTTCCGTTAACTGCTTTGGAGTATTCTCGCAATAAAGGTTCATACCATACACTTAACTTTTCTTCACCTTTGTCCAGTAAATTTCTCAAGGCAGAATTCCTATAATGCACAGTCTCAAGATCTATAATAGCACCTGCGCTCCCATCACCTATCAAGCTGCCCATCACCTTTGGCATCTCATTGAGCAGAAATTTTGAAGTGTATTCGTATCTCGTCAAGGTTTCTACTACTTGCATTTGTTCTAAGTACGGTAGTCTTAAGACAATCTCAGCACTAAACTTGTTTCTTATAGCATTGAAACATTCTTCATCTGCTGAAAGATTTCTCAACATTCCAATGCTGTAGCCACTGACGTGAAAATAGTTTTCGACCACATCTTTATGATATTTTACCAAGTACTGCGGATTAATTAATTCCAACCACTCGGTTATTAATTTTGCTTCGGACCCAATTTTTAAAGAATCTTTGTCCATAGTCTTGAATAAAGAATATTCATCTTCCTCAATTCGTGACACCTCTGCGAATAACTGTAAAAGACAATTTGTAGAAAAGGCCCTGACATCAGGATAGTTCTCCGTGTCTTCAAAAAGTTGAGCAAATACTGGCAGTATTTTTTTTACATGTCTTAAAGCCCAGTATTTATCTTGATTTCGTATTTCCAGCAAAAACTTAGTATAATAATTAACCAATTCGATGAAAACGAGGATATCTTCAACGGATTTCAGTATCTCTTCTTTAGTAAAGCAAAATATGATATCCTTGAACTCAGGACCGCTGATGAATTGAAACTCAATAGTCAAGAAGTCAATTAATCTGACAAAAGAAACCGTTTCCATTCTACCCTTTACGCTCACCAGGTATGGCAAATTATTATCAAATAATCGACGCCTAATCAATTCATCTGTACTCAACCTTTCCAACGCTTTTTCGATTGCTGTAATGAGCTTATCATTCTCCACTTTCTCATCAAATAGAATATCCAATAGAATATCGATGATATTACTGGTCGCGAATAAACCCTTTGGCTGCGAATTCTCAATGACTCTACATGCTGCTACTTTTAATGGATCTATTTCTGACCTAAGGGCCTTCACTAAGTCCTCCGCGCTATAAACTTCTAGAACATCGTCAAAATCAGCCATGGGAACAAGCTTGTCCACAACGTCCAAAAGGTAATCGTAATTCAATGAATCATAGGATACGTTAGACGTCAGAAAACGCTTGATCGTAGCCAGTAGTGGTTTAACATCCATATCTGGAAGGGAGACAACAGTCACAAGATTCAAAGAACATTTCCTTAATAGTGTGTTGATATCTTCAGGCAAGTTATCTTCATTAAGTTCATTTTCTAATTGCGTAAGGAGATTTTCCACGTAATTTGTTTCTTTCTCACTCATTGCTCCTGTTTCGCTGAGTTCTTTTGCGGTGATTATAGTTGTAAACTTGTTTTATTTTTAATCCCGTAATTAAGGTGTTTATATAAACTTACTCTTCAATTTTTCTATATGCATTTGAAACAGAAAAAAAGATATAAAAATACCAGCTATAACAAAAATCCATGTAAATAAAATTACTGTATATTTTTTTATGTAATCTAATCAAAAAAAATTCACGTCTAATACTAGTCATAAATGGAGTTGAAGCCATTAACTACTTATTTTTTATCTTCGTCCTTTTTCTTTTCTAAATGGACATTATTACCATTAAAGGTTGTTGGGTCTTCAGGATCTTCTTGATGATCGTTGTTAACAAATTGGAAAACATTTGGCGAGACAGAACGTGACGTAGTAAGGTTGGTTTCCGATGGGTACCTGGTTCCGCTAGGTGTCAGCATTGGTGATGCATGAGCAGATGATTGAACTGGTTCCCGAACATTGTTGTATTGGAAACAGCTTGACGAAGCAGCTCCAGATAAAGGTGTTGAAGACCTCACTTCGTGACGATTCGGCTTCGATGTTTCCTCACGTTGTGATGTTACTTCAGGATCTTTATCGTTGTGCCACCACGTAGAGAATCCCTTATAAAGACGGCCCAAAAGGCTTGGTCCCTCCATCCCAGTCACAGATAGCCCCGAGTTTTGAGTTTCTAGTGGTTTAAGTAATAATGCAGACCTTGGAGTTAGTTCTAGTGTCTCTAGCGTCTTCAATTCATCAGAATCCTTAAATGTCACTCTGGGAATGCCCCTGTGGAATGAGTACGGGCAGTCTCCATCTGTCCTGTTGACGTCCACCCATTTTCTAACGTCATTTAATGTTTCAGACGAGTTGAACTCATGTTTTAGAGTCTTGCCATCAGTCATCCTGATTTGCAAGACGCATTTGCTGCTGTGCAGTTTTTGTGCGTCTTTTATGTAATCATGAACATCCAATGGCTTATCATCATCAAGGGTTCTGTGATGAGTTTCATCAAGAGCTTTTCTTTCTGCACGGTCTGCCCTAACAAGTCTTATAATTCTTTCTCTTTCCTCCTCAGCCAGCTTTCTTTGTTTCAGTTGTTCACGACGTTGGATCTCTAAGGTAGTCTCAGCAATCCGTTCTCTTGCATTTTTCCTATGGACGTCTCTGGATGACTTTTCTTCTCTAGCCAAACCTGGATTGGTTTCCCTGGACGAACTCTCACCAGCCTTTTTGTCTTTGATGCCTATGCACGCCAGCAACTTCTCCCAATGTCGGTCATCCTCGCCTTGAATAATCAATTCTATCTTTCCAGCACGTATCAAGTATATACTGGGTACAACTACATTAGGAAATACTTGCTCAAATAACTGGAACTGCTCAGTGTCTTTGACCAACCTCAACCAAATACTATGTTCCGCTAAAGTATCTAATGAGACATCATCTCCTTTAAACCAACTTTTCAGCCACTGGTCATCCCGTGCAGTGTTGTAAACGGCCAGCACAACGCCTTCCTTGATGGAATCGTTTATTGCTTCTTCCACAGAATCTCTAAACAGTGCTTCTAACATTTGGTTACGGCTGTTTGGTTTAGCTATCCTTGCTTCTTTGTAAGTGCTTTCAACCTCAACCCAGCTCCCTTTTAAATTTTCAACATTACTACGAGGCCTGCCGAAGTTAATAAAGAGCGGCTTTAAATGTCATTTTAATAATTGAATGGCAAATAAAAACAACTACAGCTTCAAACATAAGAGTATATCATAAGTTGCTGTATATGGGCAGCACGTATTACTATGAGTCTCTCGCAGGTGTCACCTTTACCCCATATCAAGGATGTTGTTTTAGGAGATACAGTAGGCCAAGGCGCATTCGCCTGCGTTAAAAATGCTCATCTTCAAATGGATCCCTCCATTATTCTAGCTGTTAAATTCATTCATGTTCCCACTTGCAAAAAAATGGGACTCAGTGACAAGGATATCACAAAAGAGGTTGTTTTGCAATCGAAGTGTTCTAAGCATCCTAATGTTTTGAGACTTATCGATTGTAATGTCTCTAAAGAATATATGTGGATAATTCTGGAGATGGCAGATGGTGGTGATCTATTTGATAAGATTGAGCCTGACGTTGGAGTTGATTCCGACGTGGCCCAATTTTACTTTCAACAGCTCGTTAGTGCTATTAATTATCTGCATGTAGAATG"
input=tokenizer(dna, return_tensors = 'pt',truncation=True, max_length=128)["input_ids"]
output=model(input)
logits = output.logits
predicted_classes = torch.argmax(logits, dim=-1)
print("Predicted classes:", predicted_classes)
